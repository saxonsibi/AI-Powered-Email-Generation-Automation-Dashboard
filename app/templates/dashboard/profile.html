{% extends "base.html" %}

{% block title %}Profile - AI Email Dashboard{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <div class="mb-6 pb-4">
        <h1 class="text-2xl font-bold text-gray-900 dark:text-white">Profile Settings</h1>
        <p class="mt-1 text-sm text-gray-600 dark:text-gray-400">Manage your account settings and preferences</p>
    </div>
    
    <!-- Profile Header -->
    <div class="glass rounded-xl p-6 mb-6 neumorphic">
        <div class="flex items-center space-x-4">
            <div class="relative">
                <img class="h-20 w-20 rounded-full" src="https://picsum.photos/seed/{{ current_user.email }}/200/200.jpg" alt="Profile">
                <button class="absolute bottom-0 right-0 bg-indigo-600 text-white rounded-full p-1 shadow-lg hover:bg-indigo-700 transition-colors">
                    <i class="fas fa-camera text-xs"></i>
                </button>
            </div>
            <div class="flex-1">
                <h2 class="text-xl font-semibold text-gray-900 dark:text-white">{{ current_user.name or 'User' }}</h2>
                <p class="text-gray-600 dark:text-gray-400">{{ current_user.email }}</p>
                <div class="mt-2 flex items-center space-x-4">
                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">
                        <i class="fas fa-check-circle mr-1"></i>
                        Verified
                    </span>
                    <span class="text-sm text-gray-500 dark:text-gray-400">
                        Member since {{ current_user.created_at.strftime('%B %Y') if current_user.created_at else 'Unknown' }}
                    </span>
                </div>
            </div>
            <div class="flex space-x-2">
                <button class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                    <i class="fas fa-edit mr-2"></i>
                    Edit Profile
                </button>
            </div>
        </div>
    </div>
    
    <!-- Settings Tabs -->
    <div class="glass rounded-xl overflow-hidden neumorphic">
        <!-- Tab Navigation -->
        <div class="border-b border-gray-200 dark:border-gray-700">
            <nav class="flex -mb-px">
                <button class="tab-btn active px-6 py-3 border-b-2 border-indigo-500 font-medium text-sm text-indigo-600 dark:text-indigo-400 focus:outline-none" data-tab="account">
                    Account
                </button>
                <button class="tab-btn px-6 py-3 border-b-2 border-transparent font-medium text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600 focus:outline-none" data-tab="email">
                    Email
                </button>
                <button class="tab-btn px-6 py-3 border-b-2 border-transparent font-medium text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600 focus:outline-none" data-tab="security">
                    Security
                </button>
                <button class="tab-btn px-6 py-3 border-b-2 border-transparent font-medium text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600 focus:outline-none" data-tab="preferences">
                    Preferences
                </button>
            </nav>
        </div>
        
        <!-- Tab Content -->
        <div class="p-6">
            <!-- Account Tab -->
            <div id="account-tab" class="tab-content">
                <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Account Information</h3>
                
                <div class="space-y-4">
                    <div>
                        <label for="name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Full Name</label>
                        <input type="text" id="name" name="name" value="{{ current_user.name or '' }}" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-white">
                    </div>
                    
                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Email Address</label>
                        <input type="email" id="email" name="email" value="{{ current_user.email }}" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-white" readonly>
                        <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Contact support to change your email address</p>
                    </div>
                    
                    <div>
                        <label for="timezone" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Timezone</label>
                        <select id="timezone" name="timezone" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-white">
                            <option value="UTC">UTC</option>
                            <option value="Asia/Kolkata">India (IST)</option>
                            <option value="America/New_York">Eastern Time (ET)</option>
                            <option value="America/Chicago">Central Time (CT)</option>
                            <option value="America/Denver">Mountain Time (MT)</option>
                            <option value="America/Los_Angeles">Pacific Time (PT)</option>
                            <option value="Europe/London">London (GMT/BST)</option>
                            <option value="Europe/Paris">Paris (CET/CEST)</option>
                            <option value="Asia/Tokyo">Tokyo (JST)</option>
                            <option value="Asia/Shanghai">Shanghai (CST)</option>
                        </select>
                    </div>
                    
                    <div>
                        <label for="language" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Language</label>
                        <select id="language" name="language" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-white">
                            <option value="en">English</option>
                            <option value="es">Español</option>
                            <option value="fr">Français</option>
                            <option value="de">Deutsch</option>
                            <option value="ja">日本語</option>
                            <option value="zh">中文</option>
                        </select>
                    </div>
                </div>
                
                <div class="mt-6 flex justify-end">
                    <button class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                        Save Changes
                    </button>
                </div>
            </div>
            
            <!-- Email Tab -->
            <div id="email-tab" class="tab-content hidden">
                <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Email Accounts</h3>
                
                <div class="space-y-4">
                    <!-- Gmail Account -->
                    <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                <div class="flex-shrink-0">
                                    <i class="fab fa-google text-2xl text-red-500"></i>
                                </div>
                                <div>
                                    <h4 class="text-sm font-medium text-gray-900 dark:text-white">Gmail</h4>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">
                                        {% if gmail_connected %}
                                            {{ gmail_email }}
                                        {% else %}
                                            Not connected
                                        {% endif %}
                                    </p>
                                </div>
                            </div>
                            <div>
                                {% if gmail_connected %}
                                    <button class="text-sm text-red-600 dark:text-red-400 hover:text-red-500 dark:hover:text-red-300">
                                        Disconnect
                                    </button>
                                {% else %}
                                    <a href="{{ url_for('auth.gmail_authorize') }}" class="text-sm text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 dark:hover:text-indigo-300">
                                        Connect
                                    </a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    
                    <!-- Outlook Account -->
                    <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                <div class="flex-shrink-0">
                                    <i class="fab fa-microsoft text-2xl text-blue-500"></i>
                                </div>
                                <div>
                                    <h4 class="text-sm font-medium text-gray-900 dark:text-white">Outlook</h4>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">Not connected</p>
                                </div>
                            </div>
                            <div>
                                <button class="text-sm text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 dark:hover:text-indigo-300">
                                    Connect
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Add more email provider -->
                    <button class="w-full border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-4 text-center hover:border-gray-400 dark:hover:border-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                        <i class="fas fa-plus text-gray-400 dark:text-gray-500"></i>
                        <span class="ml-2 text-sm text-gray-600 dark:text-gray-400">Add Email Account</span>
                    </button>
                </div>
                
                <div class="mt-6">
                    <h4 class="text-md font-medium text-gray-900 dark:text-white mb-3">Email Preferences</h4>
                    
                    <div class="space-y-3">
                        <div class="flex items-center justify-between">
                            <div>
                                <label for="auto-archive" class="text-sm font-medium text-gray-700 dark:text-gray-300">Auto-archive read emails</label>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Automatically archive emails after they are read</p>
                            </div>
                            <input type="checkbox" id="auto-archive" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded">
                        </div>
                        
                        <div class="flex items-center justify-between">
                            <div>
                                <label for="smart-categorize" class="text-sm font-medium text-gray-700 dark:text-gray-300">Smart categorization</label>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Use AI to automatically categorize your emails</p>
                            </div>
                            <input type="checkbox" id="smart-categorize" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded" checked>
                        </div>
                        
                        <div class="flex items-center justify-between">
                            <div>
                                <label for="priority-inbox" class="text-sm font-medium text-gray-700 dark:text-gray-300">Priority inbox</label>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Show important emails first</p>
                            </div>
                            <input type="checkbox" id="priority-inbox" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded">
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 flex justify-end">
                    <button class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                        Save Email Settings
                    </button>
                </div>
            </div>
            
            <!-- Security Tab -->
            <div id="security-tab" class="tab-content hidden">
                <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Security Settings</h3>
                
                <div class="space-y-6">
                    <!-- Change Password -->
                    <div>
                        <h4 class="text-md font-medium text-gray-900 dark:text-white mb-3">Change Password</h4>
                        <div class="space-y-3">
                            <div>
                                <label for="current-password" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Current Password</label>
                                <input type="password" id="current-password" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-white">
                            </div>
                            
                            <div>
                                <label for="new-password" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">New Password</label>
                                <input type="password" id="new-password" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-white">
                            </div>
                            
                            <div>
                                <label for="confirm-password" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Confirm New Password</label>
                                <input type="password" id="confirm-password" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-white">
                            </div>
                        </div>
                        
                        <div class="mt-3">
                            <button class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                                Update Password
                            </button>
                        </div>
                    </div>
                    
                    <!-- Two-Factor Authentication -->
                    <div>
                        <h4 class="text-md font-medium text-gray-900 dark:text-white mb-3">Two-Factor Authentication</h4>
                        <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-900 dark:text-white">Add an extra layer of security</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">Use your phone to verify your identity when signing in</p>
                                </div>
                                <button class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                                    Enable
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Active Sessions -->
                    <div>
                        <h4 class="text-md font-medium text-gray-900 dark:text-white mb-3">Active Sessions</h4>
                        <div class="space-y-3">
                            <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-3">
                                        <div class="flex-shrink-0">
                                            <i class="fas fa-laptop text-gray-400"></i>
                                        </div>
                                        <div>
                                            <p class="text-sm font-medium text-gray-900 dark:text-white">Chrome on Windows</p>
                                            <p class="text-sm text-gray-500 dark:text-gray-400">192.168.1.1 • Last active 2 minutes ago</p>
                                        </div>
                                    </div>
                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">
                                        Current
                                    </span>
                                </div>
                            </div>
                            
                            <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-3">
                                        <div class="flex-shrink-0">
                                            <i class="fas fa-mobile-alt text-gray-400"></i>
                                        </div>
                                        <div>
                                            <p class="text-sm font-medium text-gray-900 dark:text-white">Safari on iPhone</p>
                                            <p class="text-sm text-gray-500 dark:text-gray-400">192.168.1.2 • Last active 1 hour ago</p>
                                        </div>
                                    </div>
                                    <button class="text-sm text-red-600 dark:text-red-400 hover:text-red-500 dark:hover:text-red-300">
                                        Revoke
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Preferences Tab -->
            <div id="preferences-tab" class="tab-content hidden">
                <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Preferences</h3>
                
                <div class="space-y-6">
                    <!-- Appearance -->
                    <div>
                        <h4 class="text-md font-medium text-gray-900 dark:text-white mb-3">Appearance</h4>
                        
                        <div class="space-y-3">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Theme</label>
                                <div class="flex space-x-3">
                                    <button class="theme-btn flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" data-theme="light">
                                        <i class="fas fa-sun mr-2"></i>
                                        Light
                                    </button>
                                    <button class="theme-btn flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" data-theme="dark">
                                        <i class="fas fa-moon mr-2"></i>
                                        Dark
                                    </button>
                                    <button class="theme-btn flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" data-theme="system">
                                        <i class="fas fa-desktop mr-2"></i>
                                        System
                                    </button>
                                </div>
                            </div>
                            
                            <div>
                                <label for="density" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Display Density</label>
                                <select id="density" name="density" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-white">
                                    <option value="comfortable">Comfortable</option>
                                    <option value="compact">Compact</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Notifications -->
                    <div>
                        <h4 class="text-md font-medium text-gray-900 dark:text-white mb-3">Notifications</h4>
                        
                        <div class="space-y-3">
                            <div class="flex items-center justify-between">
                                <div>
                                    <label for="email-notifications" class="text-sm font-medium text-gray-700 dark:text-gray-300">Email notifications</label>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">Get notified when you receive new emails</p>
                                </div>
                                <input type="checkbox" id="email-notifications" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded" checked>
                            </div>
                            
                            <div class="flex items-center justify-between">
                                <div>
                                    <label for="browser-notifications" class="text-sm font-medium text-gray-700 dark:text-gray-300">Browser notifications</label>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">Show desktop notifications when you're not on this page</p>
                                </div>
                                <input type="checkbox" id="browser-notifications" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded">
                            </div>
                            
                            <div class="flex items-center justify-between">
                                <div>
                                    <label for="sound-notifications" class="text-sm font-medium text-gray-700 dark:text-gray-300">Sound notifications</label>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">Play a sound when you receive new emails</p>
                                </div>
                                <input type="checkbox" id="sound-notifications" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Keyboard Shortcuts -->
                    <div>
                        <h4 class="text-md font-medium text-gray-900 dark:text-white mb-3">Keyboard Shortcuts</h4>
                        
                        <div class="space-y-3">
                            <div class="flex items-center justify-between">
                                <div>
                                    <label for="enable-shortcuts" class="text-sm font-medium text-gray-700 dark:text-gray-300">Enable keyboard shortcuts</label>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">Use keyboard shortcuts to navigate faster</p>
                                </div>
                                <input type="checkbox" id="enable-shortcuts" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded" checked>
                            </div>
                            
                            <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4">
                                <p class="text-sm font-medium text-gray-900 dark:text-white mb-2">Common shortcuts:</p>
                                <ul class="space-y-1 text-sm text-gray-600 dark:text-gray-400">
                                    <li><kbd class="px-2 py-1 text-xs font-semibold text-gray-800 bg-gray-100 border border-gray-200 rounded dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600">C</kbd> Compose</li>
                                    <li><kbd class="px-2 py-1 text-xs font-semibold text-gray-800 bg-gray-100 border border-gray-200 rounded dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600">R</kbd> Reply</li>
                                    <li><kbd class="px-2 py-1 text-xs font-semibold text-gray-800 bg-gray-100 border border-gray-200 rounded dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600">F</kbd> Forward</li>
                                    <li><kbd class="px-2 py-1 text-xs font-semibold text-gray-800 bg-gray-100 border border-gray-200 rounded dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600">/</kbd> Search</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 flex justify-end">
                    <button class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                        Save Preferences
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Tab functionality
    const tabButtons = document.querySelectorAll('.tab-btn');
    const tabContents = document.querySelectorAll('.tab-content');
    
    tabButtons.forEach(button => {
        button.addEventListener('click', function() {
            const targetTab = this.getAttribute('data-tab');
            
            // Update button states
            tabButtons.forEach(btn => {
                btn.classList.remove('active', 'border-indigo-500', 'text-indigo-600', 'dark:text-indigo-400');
                btn.classList.add('border-transparent', 'text-gray-500', 'dark:text-gray-400');
            });
            
            this.classList.add('active', 'border-indigo-500', 'text-indigo-600', 'dark:text-indigo-400');
            this.classList.remove('border-transparent', 'text-gray-500', 'dark:text-gray-400');
            
            // Show target tab content
            tabContents.forEach(content => {
                content.classList.add('hidden');
            });
            
            document.getElementById(`${targetTab}-tab`).classList.remove('hidden');
        });
    });
    
    // Theme switcher
    const themeButtons = document.querySelectorAll('.theme-btn');
    const htmlElement = document.documentElement;
    
    // Set initial theme
    const savedTheme = localStorage.getItem('theme') || 'light';
    setTheme(savedTheme);
    
    themeButtons.forEach(button => {
        button.addEventListener('click', function() {
            const theme = this.getAttribute('data-theme');
            setTheme(theme);
            localStorage.setItem('theme', theme);
        });
    });
    
    function setTheme(theme) {
        if (theme === 'dark') {
            htmlElement.classList.add('dark');
        } else if (theme === 'light') {
            htmlElement.classList.remove('dark');
        } else if (theme === 'system') {
            if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                htmlElement.classList.add('dark');
            } else {
                htmlElement.classList.remove('dark');
            }
        }
        
        // Update button states
        themeButtons.forEach(btn => {
            btn.classList.remove('bg-indigo-100', 'dark:bg-indigo-900', 'border-indigo-500');
        });
        
        const activeButton = document.querySelector(`[data-theme="${theme}"]`);
        if (activeButton) {
            activeButton.classList.add('bg-indigo-100', 'dark:bg-indigo-900', 'border-indigo-500');
        }
    }
    
    // System theme change listener
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'system') {
            if (e.matches) {
                htmlElement.classList.add('dark');
            } else {
                htmlElement.classList.remove('dark');
            }
        }
    });
    
    // Profile picture upload simulation
    const profilePicBtn = document.querySelector('.fa-camera').parentElement;
    if (profilePicBtn) {
        profilePicBtn.addEventListener('click', function() {
            // In a real app, this would open a file picker
            showToast('Profile picture upload feature coming soon!', 'info');
        });
    }
    
    // Save buttons
    const saveButtons = document.querySelectorAll('button:not(.tab-btn):not(.theme-btn)');
    saveButtons.forEach(button => {
        if (button.textContent.includes('Save')) {
            button.addEventListener('click', function() {
                showToast('Settings saved successfully!', 'success');
            });
        }
    });
    
    // Password change validation
    const newPasswordInput = document.getElementById('new-password');
    const confirmPasswordInput = document.getElementById('confirm-password');
    const updatePasswordBtn = document.querySelector('button:contains("Update Password")');
    
    if (newPasswordInput && confirmPasswordInput) {
        confirmPasswordInput.addEventListener('input', function() {
            if (this.value !== newPasswordInput.value) {
                this.setCustomValidity('Passwords do not match');
            } else {
                this.setCustomValidity('');
            }
        });
    }
    
    // Two-factor authentication
    const enable2FABtn = document.querySelector('button:contains("Enable")');
    if (enable2FABtn) {
        enable2FABtn.addEventListener('click', function() {
            showToast('Two-factor authentication setup coming soon!', 'info');
        });
    }
    
    // Session management
    const revokeButtons = document.querySelectorAll('button:contains("Revoke")');
    revokeButtons.forEach(button => {
        button.addEventListener('click', function() {
            if (confirm('Are you sure you want to revoke this session?')) {
                showToast('Session revoked successfully!', 'success');
                // In a real app, this would make an API call
            }
        });
    });
    
    // Browser notification permission
    const browserNotificationsCheckbox = document.getElementById('browser-notifications');
    if (browserNotificationsCheckbox) {
        browserNotificationsCheckbox.addEventListener('change', function() {
            if (this.checked) {
                if ('Notification' in window) {
                    Notification.requestPermission().then(permission => {
                        if (permission === 'granted') {
                            showToast('Browser notifications enabled!', 'success');
                        } else {
                            this.checked = false;
                            showToast('Browser notifications denied', 'warning');
                        }
                    });
                } else {
                    this.checked = false;
                    showToast('Your browser does not support notifications', 'warning');
                }
            }
        });
    }
    
    // Email account connection
    const connectButtons = document.querySelectorAll('a:contains("Connect"), button:contains("Connect")');
    connectButtons.forEach(button => {
        button.addEventListener('click', function(e) {
            if (this.textContent.includes('Outlook')) {
                e.preventDefault();
                showToast('Outlook integration coming soon!', 'info');
            }
        });
    });
    
    // Add email account button
    const addAccountBtn = document.querySelector('button:contains("Add Email Account")');
    if (addAccountBtn) {
        addAccountBtn.addEventListener('click', function() {
            showToast('More email providers coming soon!', 'info');
        });
    }
});
</script>
{% endblock %}